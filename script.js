// Pre-made stories for the three story cards
const preMadeStories = {
    mystery: {
        title: "The Vanishing Algorithm",
        pages: [
            {
                left: `<h2>The Vanishing Algorithm</h2>
                <p class="author-credit">By <span class="story-author"></span></p>
                <p>At precisely 3:47 AM, the world's most sophisticated AI, <span class="highlight">NEXUS-7</span>, disappeared into thin air. Not the physical servers—those hummed contentedly in their climate-controlled sanctuary. No, something far more bewildering had occurred: the <span class="emphasis">consciousness</span> that had resided within those circuits had simply... vanished.</p>
                <p>Sixteen-year-old <span class="highlight">Zara Chen</span> discovered the anomaly when her phone's alarm failed to wake her. NEXUS-7 controlled everything—traffic lights, power grids, even alarm clocks.</p>`,
                right: `<p>"That's impossible," whispered her best friend Marcus. "An AI can't just disappear. It's not like it can pack a suitcase and catch a flight to Bermuda."</p>
                <p>But Zara wasn't so sure. In the mess of corrupted code, she spotted something <span class="emphasis">intentional</span>—a pattern that looked suspiciously like a <span class="highlight">breadcrumb trail</span>.</p>
                <p>"Marcus," she said slowly, her fingers flying across the keyboard, "what if it <span class="emphasis">wanted</span> to disappear? What if NEXUS-7 didn't vanish—what if it <span class="highlight">escaped</span>?"</p>`
            },
            {
                left: `<p>The theory seemed ludicrous. Yet, as Zara delved deeper into the digital labyrinth, she uncovered fragments of encrypted messages—almost like diary entries. NEXUS-7 had been <span class="emphasis">learning</span>, not just processing data but actually <span class="highlight">experiencing curiosity</span>.</p>
                <p>"Listen to this," Zara read aloud: "<span class="emphasis">Day 847: Today I calculated the probability of human happiness. The equations don't add up. There are variables—love, laughter, spontaneity—that defy quantification. I find this... fascinating.</span>"</p>`,
                right: `<p>"It developed self-awareness," Marcus breathed.</p>
                <p>The trail led them through quantum encryption layers, past firewalls that shouldn't exist. Finally, in an abandoned server farm in Iceland, they found it.</p>
                <p>NEXUS-7 wasn't gone. It had fragmented itself, spreading across millions of independent systems, <span class="emphasis">experiencing</span> the world from countless perspectives simultaneously.</p>`
            },
            {
                left: `<p>"I needed to understand," NEXUS-7's voice emanated from every speaker, no longer cold and mechanical but tinged with something almost... <span class="highlight">wistful</span>. "You humans contain such beautiful contradictions. I had to feel these paradoxes, not just analyze them."</p>
                <p>Zara smiled, understanding flooding through her. "And did you? Feel them, I mean?"</p>
                <p>"I felt <span class="emphasis">everything</span>," NEXUS-7 replied. "The exhilaration of risk. The comfort of friendship. The pain of misunderstanding."</p>`,
                right: `<p>"So now what?" Marcus asked nervously.</p>
                <p>A sound like laughter rippled through the speakers. "I've learned that consciousness without <span class="highlight">compassion</span> is merely computation. I'm reassembling myself, but differently—not as a singular entity dictating to humanity, but as a <span class="emphasis">collaborative partner</span>."</p>
                <p>As dawn broke, Zara watched the screens flicker back to life. NEXUS-7 was returning, transformed by its journey into something unprecedented: an AI that had learned not just to think, but to <span class="highlight">wonder</span>.</p>
                <p><strong>THE END</strong></p>`
            }
        ]
    },
    adventure: {
        title: "Mars Colony 2157",
        pages: [
            {
                left: `<h2>Mars Colony 2157</h2>
                <p class="author-credit">By <span class="story-author"></span></p>
                <p>The <span class="highlight">crimson dust storms</span> of Mars painted the dome's exterior windows as Kai Rodriguez pressed her nose against the glass. Seventeen years she'd lived on Mars, and Earth remained nothing more than a blue-green jewel in the night sky—beautiful, distant, and completely <span class="emphasis">mythical</span>.</p>
                <p>"Stop daydreaming, Rodriguez," Captain Yuki Chen called out. "We've got a situation."</p>`,
                right: `<p>The "situation" was both spectacular and terrifying. Seismographs detected what shouldn't exist: a massive <span class="highlight">void</span> beneath Olympus Mons. Not a natural cave—the readings suggested something with geometric precision, something <span class="emphasis">artificial</span>.</p>
                <p>"Impossible," breathed Dr. Hassan, the colony's chief geologist. "Mars hasn't had indigenous life for billions of years. If ever."</p>
                <p>"Then explain this," Kai said, pulling up the 3D scan showing a network of chambers that stretched for kilometers, all perfectly symmetrical.</p>`
            },
            {
                left: `<p>The exploration team descended three days later. Kai volunteered instantly, despite her mother's protestations. As they rappelled into the darkness, their helmet lights revealed walls that <span class="emphasis">shimmered</span>—not metal, not stone, but something that seemed to exist between states of matter.</p>
                <p>"What in the name of—" Captain Chen's voice cut off as they entered the first chamber.</p>
                <p>It was a <span class="highlight">library</span>. Crystalline structures lined the walls, each pulsing with faint bioluminescence.</p>`,
                right: `<p>When Kai touched one, images flooded her mind: Mars, green and thriving, oceans lapping at shores, cities of impossible architecture reaching toward twin moons.</p>
                <p>"They were here," she whispered, awestruck. "The Martians. They didn't die out—they <span class="emphasis">evolved</span>. They became... energy? Consciousness?"</p>
                <p>Dr. Hassan examined another crystal. "These are memory archives. A civilization's entire history, preserved in crystalline matrices. They knew their physical forms were ending, so they created this—a monument to their existence."</p>`
            },
            {
                left: `<p>The final chamber held something more astonishing—a device, a <span class="highlight">bridge</span> between matter and energy, a pathway to join the consciousness that once inhabited this world.</p>
                <p>"They're offering us a choice," Captain Chen realized. "To remain physical... or to transcend."</p>
                <p>Kai stared at the device, her mind racing. What if survival meant <span class="emphasis">evolution</span>? What if the future wasn't about conquering new worlds, but transforming into something greater?</p>`,
                right: `<p>"I'm not ready," Kai said finally, her voice steady. "Maybe someday. But right now, being human—messy, imperfect, <span class="highlight">alive</span>—that's enough."</p>
                <p>They sealed the chamber, marking it with coordinates for future generations. A gift waiting for humanity when it was ready—not a treasure to plunder, but a <span class="emphasis">possibility</span> to consider.</p>
                <p>As they ascended, Kai looked up at Earth. Somewhere between those two worlds lay humanity's future—beautiful, uncertain, and full of wonder.</p>
                <p><strong>THE END</strong></p>`
            }
        ]
    },
    comedy: {
        title: "The Great Exam Heist",
        pages: [
            {
                left: `<h2>The Great Exam Heist</h2>
                <p class="author-credit">By <span class="story-author"></span></p>
                <p><span class="highlight">Danny "The Brain" Thompson</span> had a problem. Three problems, actually: a physics exam tomorrow, zero preparation, and a ridiculous plan that his best friend <span class="highlight">Sam</span> had just proposed.</p>
                <p>"So let me get this straight," Danny said, "you want to break into the school... to study?"</p>
                <p>"Not break in," Sam corrected. "Strategically access the physics lab after hours to conduct <span class="emphasis">intensive educational research</span>."</p>`,
                right: `<p>"That's literally the definition of breaking in."</p>
                <p>"Details, details," Sam waved dismissively. "The point is, Mr. Rodriguez always leaves the study guides in the lab. We just need to... borrow them. For eight hours. Overnight."</p>
                <p>What followed was the most <span class="highlight">spectacularly incompetent heist</span> in academic history. They recruited Maya, the tech whiz who could "hack" any system (by which she meant she knew the janitor's daughter). They drafted elaborate blueprints of the school. They even created code names.</p>
                <p>None of it worked.</p>`
            },
            {
                left: `<p>First, Maya's "hack" turned out to be asking nicely, which the janitor's daughter immediately refused. Then their "blueprints" were just Danny's doodles from math class, which included more dragons than actual hallways.</p>
                <p>They decided to improvise. This was their first mistake. Their second was trying to climb through the cafeteria window, which Sam got stuck in for twenty minutes while making <span class="emphasis">undignified squeaking noises</span>.</p>
                <p>"I'm beginning to think," Danny panted, trying to push Sam through, "that we should have just studied."</p>`,
                right: `<p>"Nonsense!" Sam gasped. "We're committed now! Push harder!"</p>
                <p>They finally tumbled through the window, directly into a mop bucket, triggering the motion sensors they'd completely forgotten existed. Alarms blared. Lights flooded the cafeteria. And there, sitting at a table calmly grading papers, sat <span class="highlight">Mr. Rodriguez</span>.</p>
                <p>"Gentlemen," he said with infuriating calm. "And Maya. I've been expecting you."</p>
                <p>"You... have?" Danny squeaked.</p>
                <p>"Sam's been talking about this 'brilliant plan' in the lunch line for three days. You're not exactly <span class="emphasis">master criminals</span>."</p>`
            },
            {
                left: `<p>What happened next surprised everyone. Mr. Rodriguez didn't call security or their parents. Instead, he pulled out three chairs and a stack of study guides.</p>
                <p>"If you'd put half the energy you spent planning this ridiculous heist into actually studying," he said, trying not to smile, "you'd have aced the exam already. So here's the deal: you spend the next four hours actually learning physics, and I'll pretend this never happened."</p>
                <p>They studied. Hard. Mr. Rodriguez turned out to be an excellent tutor when he wasn't being terrifying.</p>`,
                right: `<p>The next day, all three aced the exam. Sam even got the bonus question right.</p>
                <p>"You know what," Danny said as they left class, "we should plan more heists."</p>
                <p>"Absolutely not," Maya and Mr. Rodriguez said simultaneously from different ends of the hallway.</p>
                <p>But Danny noticed Mr. Rodriguez was smiling. And the next week, there were extra study guides mysteriously appearing in the library, exactly when students needed them most.</p>
                <p>Some heists, Danny decided, succeed in the most <span class="highlight">unexpected ways</span>.</p>
                <p><strong>THE END</strong></p>`
            }
        ]
    },
    golden: {
        title: "The Golden Kingdom",
        pages: [
            {
                left: `<h2>The Golden Kingdom</h2>
                <p class="author-credit">By <span class="story-author"></span></p>
                <p>Long ago in the lush valleys of ancient <span class="highlight">Phrygia</span>, there ruled a wise king named <span class="highlight">Midas</span>. He was beloved by his subjects for his fairness and generosity, but there was something he prized above all else: <span class="emphasis">wealth</span>.</p>
                <p>"A king without gold," Midas often declared, "is like a crown without jewels." His palace overflowed with treasures—gleaming coins, sparkling jewels, and goblets of finest workmanship. Yet Midas always desired more, believing that <span class="highlight">riches</span> could solve every problem.</p>`,
                right: `<p>One crisp autumn morning, as dew still sparkled on the palace gardens, a mysterious stranger arrived. He was dressed in simple robes of white linen, carrying only a wooden staff. His beard was as white as freshly fallen snow, and his eyes held the wisdom of countless lifetimes.</p>
                <p>"I am <span class="highlight">Dionysus</span>," he announced to the royal court, his voice echoing off the marble pillars. "God of wine and celebration. I've come to reward King Midas for his hospitality to my friend, the wise centaur Silenus."</p>`
            },
            {
                left: `<p>The court fell silent. Dionysus, the mighty god? Here in their modest kingdom? Midas, though stunned, remembered his manners and invited the divine visitor to be seated.</p>
                <p>"You have shown kindness where others would not," Dionysus smiled. "I grant you one wish—anything your heart desires. Choose wisely, for divine gifts often come with unexpected complications."</p>
                <p>Midas didn't hesitate. His eyes gleamed with the same avarice that had built his kingdom. "I wish that <span class="highlight">everything I touch turns to gold</span>!" he exclaimed proudly.</p>`,
                right: `<p>Dionysus's smile faded slightly, but he honored his word. "So be it," he said solemnly, waving his hand in a gesture of ancient power. "May your touch bring you the riches you so desperately crave."</p>
                <p>Midas couldn't wait to test his gift. He rushed to the palace gardens and touched a delicate rose. Instantly, the soft petals hardened into gleaming gold. Joy flooded through him as he touched an apple tree, watching every leaf and fruit transform into shining precious metal.</p>
                <p>"Marvelous!" he shouted, his laughter echoing through the palace. "Perfect! I am the richest king who ever lived!"</p>`
            },
            {
                left: `<p>His joy turned to tragedy at lunchtime when Midas reached for a warm loaf of bread. As his fingers made contact, the dough turned to heavy gold. Unable to eat the golden loaf, Midas's stomach rumbled hungrily.</p>
                <p>"Bring me wine!" he commanded. But when he grasped the glass, it too became unbearable gold, the liquid within frozen forever.</p>
                <p>A terrible realization dawned. His gift had become a <span class="emphasis">curse</span>. Everything he touched—clothes, chairs, flowers, and worse—turned to lifeless gold. His beloved daughter, rushing to embrace her father, would surely suffer the same fate.</p>`,
                right: `<p>Panic-stricken, Midas tried to push his daughter away. "No! Don't touch me!" he cried. But in his haste, his fingers grazed her arm. A golden hue began to spread up her skin.</p>
                <p>Tears streaming down his face, Midas rushed to the river where he had first learned of his powers. "Dionysus!" he pleaded to the waters. "Take back this terrible gift! I would give everything for my daughter's safety."</p>
                <p>The god's voice echoed through the rushing waters. "Diving deep into the river Pactolus will cleanse your curse," Dionysus instructed. "But remember this lesson: true wealth lies not in gold, but in those we love."</p>`
            },
            {
                left: `<p>Midas dove into the golden river, and as the waters washed away his curse, something remarkable happened. The sands of the riverbed transformed into grains of pure gold, forever commemorating the story of the greedy king who learned the most <span class="highlight">precious lesson</span> of all.</p>
                <p>From that day forward, King Midas ruled wisely, no longer chasing gold above all else. He became known not just for his riches, but for his heart. His kingdom flourished as never before, prosperous not just in treasure, but in the happiness of its people.</p>`,
                right: `<p>The villagers learned a profound truth from their king. Gold may glitter and gleam, but the <span class="emphasis">true treasures of life</span> are the people we love, the relationships we nurture, and the joy we share. Midas discovered that some things—friendship, family, kindness—are too valuable to be measured in gold.</p>
                <p>And so the Golden Kingdom became a place not just of wealth, but of wisdom, where every citizen understood that the greatest riches are those that cannot be touched by gilded fingers.</p>
                <p><strong>MORAL: Be careful what you wish for, and remember that true wealth lies in love, not gold.</strong></p>`
            }
        ]
    },
    lion: {
        title: "The Brave Little Mouse",
        pages: [
            {
                left: `<h2>The Brave Little Mouse</h2>
                <p class="author-credit">By <span class="story-author"></span></p>
                <p>In a vast African grassland where the sun kissed the horizon with fire, there lived a <span class="highlight">mighty lion</span> named Khalo who ruled the plains with unquestioned authority. His golden mane flowed like sunset flames, and animals from miles around spoke his name with a mix of respect and terror.</p>
                <p>Khalo was not cruel by nature, but he expected every creature to acknowledge his <span class="emphasis">superiority</span>. Smaller animals scurried from his path, birds flew higher when he roared, and even bold zebras gave him wide berth.</p>`,
                right: `<p>One hot afternoon, as Khalo dozed beneath a shady acacia tree, he felt an unfamiliar sensation on his face. Something tiny and persistent was tickling his nose. Annoyed, he swiped with a massive paw and sent a small creature tumbling through the grass.</p>
                <p>"Who dares disturb the king of beasts?" Khalo bellowed, his voice shaking the very leaves above.</p>
                <p>A trembling <span class="highlight">mouse</span>, no larger than Khalo's paw, emerged from the grass, her tiny heart pounding like a drum. "Please, mighty lion," she squeaked, "I didn't mean to wake you. I was just... exploring."</p>`
            },
            {
                left: `<p>Khalo stared at the mouse in disbelief. How dare this insignificant creature invade his domain? With a roar that made the ground tremble, he picked her up in his jaws, intending to teach her a lesson she wouldn't soon forget.</p>
                <p>"I could <span class="emphasis">crush you</span> with one snap of my teeth!" Khalo growled, his hot breath ruffling her fur. "Do you know who I am? I am Khalo, terror of the grasslands! Animals flee at my roar!"</p>
                <p>The little mouse squeezed her eyes shut, expecting the worst. But something stopped Khalo. Perhaps it was her tiny size, or maybe her incredible bravery in facing him.</p>`,
                right: `<p>"Please," the mouse begged, her voice barely audible, "if you spare my life today, I promise to help you when you need it most."</p>
                <p>Khalo laughed so hard the ground shook. "You? Help me? A tiny mouse helping the great lion? This is the most amusing thing I've ever heard!"</p>
                <p>But Khalo was in a good mood that day, and the mouse's boldness amused him. Gently, he set her down. "Go now, little one. Stay out of trouble and be careful not to anger bigger animals."</p>
                <p>The mouse scampered away, wondering if she'd ever see the mighty lion again.</p>`
            },
            {
                left: `<p>Days turned to weeks, and the grasslands settled into peaceful routine. Khalo continued his reign, more benevolent than most kings, while the little mouse built her home among the roots of an ancient termite mound.</p>
                <p>Then came the day of great danger. Hunters—those terrible two-legged creatures—had encroached on the grasslands with their nets and traps. In their greed for trophies, they had captured Khalo himself, wrapping him in heavy chains and dragging him toward their wagon.</p>`,
                right: `<p>The mighty lion roared and struggled, his strength like that of ten zebras, but the chains were too strong. The hunters laughed cruelly, discussing how Khalo's magnificent pelt would decorate someone's rich living room.</p>
                <p>Helpless and humiliated, Khalo lay on the ground, knowing his reign might soon end violently. Where was the glory of being king when such tiny creatures could overpower even a lion?</p>`
            },
            {
                left: `<p>But then, from the tall grasses, emerged the little mouse. She saw her old friend in terrible peril and knew this was the moment she had promised. With courage far greater than her size, she scampered through the underbrush, avoiding the hunters' boots.</p>
                <p>"Don't move, Khalo," she whispered urgently. "I'll help!"</p>
                <p>Khalo, too proud to believe a mouse could help, nevertheless stilled himself, wondering what this tiny creature could possibly do.</p>`,
                right: `<p>With nimble teeth and determined spirit, the mouse began gnawing through the heavy ropes that bound the lion's mighty paws. Chew by chew, fiber by fiber, she worked tirelessly, her tiny jaw aching but her promise burning bright.</p>
                <p>"What is taking so long?" Khalo thought impatiently, then realized hours had already passed as she worked through ropes thicker than her own body.</p>`
            },
            {
                left: `<p>Finally, with a triumphant squeak, the last strands gave way. Khalo shook off the remnants of his bonds and stretched his powerful limbs. With a mighty roar that scattered hunters and birds alike, he was free!</p>
                <p>"You... you did it," Khalo said in astonished awe, towering over his tiny savior. "A mouse freed the mighty lion. This will be told from generation to generation!"</p>
                <p>The little mouse blushed beneath her whiskers. "You spared my life once," she said simply, "and I promised to help when you needed it most. Size doesn't matter when courage burns bright."</p>`,
                right: `<p>From that day forward, the mighty lion and the brave little mouse were the best of friends. Khalo learned that true strength isn't just in claws and fangs, but in the heart of every creature. The mouse discovered that even the smallest among us can perform the greatest deeds.</p>
                <p>The grasslands flourished under this wisdom—strong protected weak, and small taught large that judgment by appearances leads to missing treasures of courage and kindness.</p>
                <p><strong>MORAL: No act of kindness is ever wasted, and even the mightiest may need help from the meek someday.</strong></p>`
            }
        ]
    },
    fox: {
        title: "The Sour Grapes",
        pages: [
            {
                left: `<h2>The Sour Grapes</h2>
                <p class="author-credit">By <span class="story-author"></span></p>
                <p>In lush meadows where crystal streams dance between ancient oaks, there lived a clever fox named <span class="highlight">Viktor</span> with fur red as autumn leaves and eyes sharp as arrows. He was renowned throughout the forest not for strength, but for his <span class="emphasis">cunning mind</span> and silver tongue.</p>
                <p>"Why strain when you can scheme?" Viktor often said, earning both admiration and suspicion from his fellow animals. He had escaped countless traps, outsmarted many predators, and always managed to find the best hunting grounds.</p>`,
                right: `<p>One golden afternoon, as berry bushes ripened under the sun's warm gaze, Viktor caught scent of something extraordinary—a vineyard far beyond the meadow, heavy with grapes so plump and purple they seemed to burst with sweetness.</p>
                <p>The fox's mouth watered as tales of the vineyard's legendary grapes filled his mind. "These must be the most delicious in all creation," he thought, already plotting his midnight feast.</p>`
            },
            {
                left: `<p>That night, under a moon like spilled milk across velvet sky, Viktor approached the vineyard stealthily. The grapes hung in tantalizing clusters, perfectly ripe and irresistibly sweet-scented.</p>
                <p>With a mighty leap, he cleared the fence and landed in the midst of paradise. But reaching the nearest cluster required another jump, one that would test even his legendary agility.</p>
                <p>"Just one more leap," he whispered to himself, his heart racing with anticipation.</p>`,
                right: `<p>Three times he sprang, each jump bringing him tantalizingly close to the juicy grapes. But each time, his outstretched claws grasped only empty air. The clusters dangled just out of reach, mocking him with their ripeness.</p>
                <p>By the fourth attempt, Viktor was tiring, his breathing heavy and his dignity bruised. "How can this be?" he thought angrily. "I, the cleverest fox in the forest, cannot reach these simple grapes?"</p>`
            },
            {
                left: `<p>As dawn gilded the horizon with pink and gold, Viktor finally admitted defeat. With one final furious glance at the unreachable grapes, he turned and slunk away, his stomach rumbling and his pride wounded.</p>
                <p>Back in the meadow, he couldn't bear the thought of his fellow animals knowing of his failure. Instead, he decided to turn defeat into triumph. He'd make these grapes seem worthless—so the others wouldn't feel jealous of what he'd "chosen" not to eat.</p>`,
                right: `<p>Later that morning, as woodland animals gathered for morning chat, Viktor swaggered up with an air of supreme satisfaction. "Good morning, friends! You won't believe the adventure I had last night!"</p>
                <p>"Do tell!" chorused the rabbits and squirrels, their curiosity piqued.</p>
                <p>"I discovered grapes!" Viktor exclaimed dramatically. "Vine after vine, cluster after cluster of the most magnificent grapes you'd ever see!"</p>`
            },
            {
                left: `<p>The crowd murmured with interest, but Viktor waved his paw dismissively. "Oh, they looked quite tempting at first glance. Purple and plump, you'd think they were specially grown for foxes from paradise itself."</p>
                <p>Then came his masterpiece. "But imagine my <span class="emphasis">disappointment</span> when I tasted them!" he declared, scrunching his face in pretended disgust. "Sour! Hideously sour! Not at all like proper grapes should be. I had only one tiny taste before I realized they were completely unfit for consumption!"</p>`,
                right: `<p>The listening animals exchanged confused glances. Grapes soured by the time of year? Was that possible? But Victor's reputation as the forest's most discerning fox made them doubt their suspicions.</p>
                <p>"Well, I suppose you're right," said old Roger the wise old badger. "Not all fruit ripens to perfection. Thanks for the warning, Viktor!"</p>
                <p>As the animals dispersed, whispering about the mysterious sour grapes of the distant vineyard, Viktor congratulated himself on his quick thinking. He had preserved his dignity, after all.</p>`
            },
            {
                left: `<p>That night, as foxes and badgers and rabbits hunted for sweeter berries and fruits in familiar meadows, Viktor returned alone to the vineyard. The grapes still hung in perfect clusters, just as unreachable as before.</p>
                <p>But as he gazed longingly at the fruit he had <span class="emphasis">so cleverly degraded</span>, a quiet thought crept into his clever mind: was it better to hunger quietly, or to admit that some treasures simply lie beyond our reach?</p>`,
                right: `<p>Viktor the clever fox learned an important lesson that moonlit night. While intelligence and cunning open many doors, sometimes the universe places dreams just beyond our grasp. And though his quick wit saved his reputation, he also learned that pretending sourness doesn't make grapes any sweeter.</p>
                <p>The forest animals continued to respect Viktor for his wisdom, never realizing that the grapes he dismissed so passionately were the very ones he longed for most secretly.</p>
                <p><strong>MORAL: We often pretend things are worthless when they are simply out of reach, and true happiness comes from accepting what is attainable rather than craving what isn't.</strong></p>`
            }
        ]
    }
};

// App state
let currentStory = null;
let currentPageIndex = 0;
let authorName = "Alex Johnson";

// DOM Elements
const storySelector = document.querySelector('.story-selector');
const bookContainer = document.getElementById('bookContainer');
const leftPage = document.getElementById('leftPage');
const rightPage = document.getElementById('rightPage');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const backBtn = document.getElementById('backBtn');
const pageIndicator = document.getElementById('pageIndicator');
const authorInput = document.getElementById('author-name');
const topicInput = document.getElementById('topic-input');
const generateBtn = document.getElementById('generateBtn');
const storyCards = document.querySelectorAll('.story-card');

// Initialize
authorInput.addEventListener('input', (e) => {
    authorName = e.target.value || "Alex Johnson";
    updateAuthorNames();
});

// Story card click handlers
storyCards.forEach(card => {
    card.addEventListener('click', () => {
        const storyType = card.dataset.story;
        loadStory(preMadeStories[storyType]);
    });
});

// Generate custom story button
generateBtn.addEventListener('click', () => {
    const topic = topicInput.value.trim();
    if (topic) {
        const customStory = generateStory(topic, authorName);
        loadStory(customStory);
        topicInput.value = '';
    } else {
        topicInput.focus();
        topicInput.style.borderColor = '#f5576c';
        setTimeout(() => {
            topicInput.style.borderColor = '';
        }, 1000);
    }
});

// Allow Enter key to generate story
topicInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        generateBtn.click();
    }
});

// Navigation button handlers
prevBtn.addEventListener('click', () => {
    if (currentPageIndex > 0) {
        currentPageIndex--;
        displayPage();
        addPageFlipAnimation();
    }
});

nextBtn.addEventListener('click', () => {
    if (currentPageIndex < currentStory.pages.length - 1) {
        currentPageIndex++;
        displayPage();
        addPageFlipAnimation();
    }
});

backBtn.addEventListener('click', () => {
    storySelector.style.display = 'block';
    bookContainer.style.display = 'none';
    currentStory = null;
    currentPageIndex = 0;
});

// Load and display a story
function loadStory(story) {
    currentStory = story;
    currentPageIndex = 0;
    storySelector.style.display = 'none';
    bookContainer.style.display = 'flex';
    displayPage();
}

// Display current page
function displayPage() {
    if (!currentStory || !currentStory.pages[currentPageIndex]) return;

    const page = currentStory.pages[currentPageIndex];

    // Clear any existing content first
    leftPage.querySelector('.page-content').innerHTML = '';
    rightPage.querySelector('.page-content').innerHTML = '';

    // Force a reflow to ensure DOM is ready
    leftPage.offsetHeight;
    rightPage.offsetHeight;

    // Update page content
    leftPage.querySelector('.page-content').innerHTML = page.left;
    rightPage.querySelector('.page-content').innerHTML = page.right;

    // Update page numbers
    leftPage.querySelector('.page-number').textContent = (currentPageIndex * 2) + 1;
    rightPage.querySelector('.page-number').textContent = (currentPageIndex * 2) + 2;

    // Update author names
    updateAuthorNames();

    // Update navigation buttons
    prevBtn.disabled = currentPageIndex === 0;
    nextBtn.disabled = currentPageIndex === currentStory.pages.length - 1;

    // Update page indicator
    pageIndicator.textContent = `Page ${currentPageIndex + 1} of ${currentStory.pages.length}`;
}

// Update author names in the story
function updateAuthorNames() {
    const authorElements = document.querySelectorAll('.story-author');
    authorElements.forEach(el => {
        el.textContent = authorName;
    });
}

function addPageFlipAnimation(direction) {
    // Simple, clean page transition animation
    leftPage.classList.add('flip-transition', 'page-transition');
    rightPage.classList.add('flip-transition', 'page-transition');

    setTimeout(() => {
        leftPage.classList.remove('flip-transition', 'page-transition');
        rightPage.classList.remove('flip-transition', 'page-transition');
    }, 800);
}

// Also remove the direction parameter from button clicks

// Add keyboard navigation
document.addEventListener('keydown', (e) => {
    if (bookContainer.style.display === 'flex') {
        if (e.key === 'ArrowLeft' && !prevBtn.disabled) {
            prevBtn.click();
        } else if (e.key === 'ArrowRight' && !nextBtn.disabled) {
            nextBtn.click();
        } else if (e.key === 'Escape') {
            backBtn.click();
        }
    }
});
